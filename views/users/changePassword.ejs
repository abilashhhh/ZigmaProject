<%- include('../partials/userHeader.ejs') %>
<%- include('../partials/pageTopPanel.ejs') %>
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@10/dist/sweetalert2.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>


    <style>
        .error {
            color: red;
        }
    </style>
</head>

<body>
    <div class="page-header breadcrumb-wrap">
        <div class="container">
            <div class="breadcrumb">
                <a href="/" rel="nofollow">Home</a>
                <span><a href="/accountPage">Account</a></span>
                <span>Change Password</span>
            </div>
            
        </div>
    </div>
    <section class="pt-100 pb-150 d-flex justify-content-center">
        <div class="container">
          <div class="row">
            <div class="m-auto d-flex justify-content-center">
              <div class="row d-flex col-lg-5 justify-content-center">
                <div class="col-lg-12">
                  <div
                    class="login_wrap widget-taber-content p-30 background-white border-radius-10 mb-md-5 mb-lg-0 mb-sm-5  border-4">
        <div class="heading_s1">
            <h3 class="mb-30">Change Password</h3>
        </div>
        <form method="post" onsubmit="return validateForm()">
            <div class="form-group">
                <input type="password" required="" name="oldpassword" id="oldpassword" placeholder="Enter old password">
                <span id="passwordError1" class="error"></span>
            </div>

            <div class="form-group">
                <input type="password" required="" name="newpassword" id="newpassword" placeholder="Enter new password">
                <span id="passwordError2" class="error"></span>
            </div>

            <div class="form-group">
                <input type="password" required="" name="confirmpassword" id="confirmpassword"
                    placeholder="Confirm new password">
                <span id="confirmPasswordError" class="error"></span>
            </div>

            <h5 style="color: blue; margin: 20px;">
                <% if(message && typeof message !=='undefined' ){ %>
                    <%= message %>
                        <% } %>
                            <span id="generalError" class="error"></span>
            </h5>

            <div class="form-group">
                <button type="submit" class="btn btn-fill-out btn-block hover-up" name="login">Reset password</button>
            </div>
        </form>
    </div>
    <div class="col-lg-1"></div>
  </div>
  </div>
  </div>
  </div>
  </section>

        <script>
            function validateForm() {
                var newpassword = document.getElementById('newpassword').value;
                var oldpassword = document.getElementById('oldpassword').value;
                var confirmPassword = document.getElementById('confirmpassword').value;

                // Clear previous error messages
                document.getElementById('passwordError1').innerText = '';
                document.getElementById('passwordError2').innerText = '';
                document.getElementById('confirmPasswordError').innerText = '';
                document.getElementById('generalError').innerText = '';

                if (newpassword.trim() === '') {
                    document.getElementById('passwordError2').innerText = 'New password cannot be empty.';
                    return false;
                }

                if (oldpassword.trim() === '') {
                    document.getElementById('passwordError1').innerText = 'Old password cannot be empty.';
                    return false;
                }

                // 8 characters
                if (newpassword.length < 8) {
                    document.getElementById('passwordError2').innerText = 'Password must be at least 8 characters long.';
                    return false;
                }

                if (newpassword !== confirmPassword) {
                    document.getElementById('confirmPasswordError').innerText = 'Passwords do not match.';
                    return false;
                }

                return true;
            }
        </script>
    </div>

    <%- include('../partials/userAboveFooterPanel.ejs') %>
    <%- include('../partials/userFooter.ejs') %>